<html>
    <head>
    <title>TODO supply a title</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
		#roll-block{margin: 10px 35%;}
    	canvas { border: 1px solid black; }
    </style>
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
	</head>
	<script src="/socket.io/socket.io.js"></script>
    <body>
	  <canvas id="roll-block" width="400" height="400"></canvas>
	  <br>
	  <button type="button" class="btn btn-primary btn-block" id="rollbtn">roll</button>
    <script>
		// const { draw } = require('draw')
		// import { draw } from "./draw.js";

		// const { draw } = require('./draw.js')

		// console.log(obj);
		rollbtn.onclick = function() {
			socket.emit('tnp', val);
			val = !val;
			console.log("event");
		};

		let val = false;

		function draw(val){
      	  	var canvas = document.getElementById('roll-block');
			var maxLen = 4;
			let style = ['rgb(200,0,0)', 'rgb(20,20,20)'];
			let x0 = 10, y0=10, count = 1;
			let step = 30;
     		let map;
			if (val == true) {
				map = [
				[8, 9, 7, 12],
				[0, 2, 4, 1],
				[14, 10, 13, 6],
				[11, 15, 3, 5]
				];
			} else {
				map = [
				[1, 2, 3, 4],
				[5, 6, 7, 8],
				[9, 10, 11, 12],
				[13, 14, 15, 16]
				];        	
			}

	        if (canvas.getContext) {
	      	console.log(41);
	        var ctx = canvas.getContext("2d");

	        for(var x = 0; x < maxLen; x++){
	        	x0 = 10;
		        for(var y = 0; y < maxLen; y++){
		        	if (y == 0) y0 += step * 1.3;
		        	x0 += step * 1.25; 
		        	ctx.fillStyle = style[x%2? 1 - (y % 2) : y % 2]; 

      	      		ctx.fillStyle = 'rgb(' + Math.floor(255 - 42.5 * x) + ', ' + Math.floor(255 - 42.5 * y) + ', 0)';

			        ctx.fillRect (x0, y0, step, step);

			        ctx.fillStyle = 'white';
		          	ctx.font = "22px arial";
					ctx.fillText(map[x][y], x0, y0 + step * 0.75);

			        count++;
		        }
		      }
	      }
      }


	var socket = io();
	socket.on('tnp', function(msg){
		draw(msg);
		console.log(msg);
	});
	</script>
	<script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
    </body>
</html>